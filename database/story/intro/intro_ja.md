# 概要

## このワークショップについて

このワークショップは、Oracle Databaseセキュリティの機能に特化したハンズオン・ラボであり、Oracle Databasesで実行される最も一般的なサイバー攻撃を防止、検出、軽減します。各特集製品の詳細は、次のワークショップを参照してください。

*   [DBセキュリティの基本](https://apexapps.oracle.com/pls/apex/dbpm/r/livelabs/view-workshop?wid=698)
*   [「DB Security Advanced」](https://apexapps.oracle.com/pls/apex/dbpm/r/livelabs/view-workshop?wid=726)ラボ。

このラボでは、ランサムウェア攻撃を使用して、攻撃者がどのように動作するか、およびデータの抽出リスクを防止、検出および軽減するために使用する必要があるデータベース機能を確認します。

一般的なランサムウェア攻撃には、データの盗難と抽出が含まれます。盗難は通常、システムを暗号化して動作不能にする前に発生します。ランサムウェアギャングが使用する盗難データは、身代金の支払いに影響を与えるのに役立ちます。

![ランサムウェア攻撃メッセージ](./images/intro-hack-01.png "ランサムウェア攻撃メッセージ")

これを可能にするために、数分でデプロイされたOCIアーキテクチャに基づいて必要なインフラストラクチャ・コンポーネントを提供します。これにより、簡単なインターネット接続でハッカーによってデータベースで悪用される最も一般的な攻撃をテストできます。

これらのコンポーネントはすべてワークショップのDBSec-Lab VMに格納されるため、Oracle Database Security Product Managerチームが事前構成した環境でデータベース・セキュリティのユースケースをテストするために何かを壊す心配なく、リスクなく攻撃を実行できます。

_見積時間_: 40分

> ランサムウェアに慣れていない場合は、下の「詳細」セクションをお読みください

### この製品/技術について

この演習では、次のリソースを使用します。

*   SSHターミナル・クライアント
*   Oracle Databases
*   Glassfish HRアプリケーション
*   AuditVault Webコンソール
*   OEM Cloud Control (DBA Webコンソール)

Glassfish HRアプリケーションは、保護されていないPDB1という名前のOracle Databaseを指す架空の従業員管理Webアプリケーションです。このシナリオでは、このデータベースには、攻撃者がランサムウェアの支払いを延期したり、利益のためにダークウェブで販売したりするために使用できる機密データが含まれています。

攻撃プロトコルの進行に伴い、同じインタフェースから同じコマンドをテストしますが、今回はPDB2という名前の別のOracle Databaseを指しています。Oracleの推奨セキュリティ制御は、PDB2を保護します。適切に構成されたデータベースが、データの侵入や盗難に使用される最も一般的な攻撃をどのようにブロックできるかを確認できます。

_この演習でテストしたバージョン:_ Oracle DB EE 19.13、OEM 13.5、AVDF 20.5

### 目標

このラボでは、Oracle Databaseの最も重要なセキュリティ機能の使用について学習します。

次の方法について学習します。

*   データの抽出を防止、検出、軽減
*   権限のエスカレーションと不正使用の防止と検出
*   脆弱性の悪用を防止および軽減

### 前提条件

この演習では、次を想定しています。

*   Oracle Cloudアカウント- このワークショップのLiveLabsランディング・ページを参照して、サポートされている環境を確認してください
    
    _ノート:_
    
    *   _**無料トライアル**・アカウントがある場合、無料トライアルの期限が切れると、アカウントは**Always Free**アカウントに変換されます_
    *   _Always Free環境が使用可能でないかぎり、Free Tierワークショップは実行できません_
    *   _**[Free TierのFAQページはこちら](https://www.oracle.com/cloud/free/faq.html)**_
*   このワークショップの経験が可能なかぎり最適であるため、「ラボ: _環境の初期化_」を実行して、これらのリソースがすべて正しく設定されていることを確認しないでください。
    

データベース・セキュリティ・チーム全体が、優れたワークショップを望んでいます。

次の演習に進むことができます。

## さらに学ぶ

開始する前に、Oracleのデータベース・セキュリティ機能を示す例として**ランサムウェア攻撃**を使用することを選択した理由を説明します。

サイバー犯罪者はますます装備され、より良く準備されています。彼らは今、あなたがそれらに対処する準備ができていない場合、ほぼすべての場所からあなたに対する攻撃を開始することを可能にする相当な技術的武器を持っています。

攻撃者の動機を理解し、盗まれたデータをあなたに対して使用できないようにする方法は、攻撃を生き延び、身代金を支払わないことがより実現可能にするのに役立ちます。

ランサムウェアは、最近の[ENISAレポート](https://www.enisa.europa.eu/publications/enisa-threat-landscape-2021)によると、今日の世界の主要な脅威の1つです(攻撃の数は毎日増加し、すべてのセクターが例外なく影響を受けます)。ランサムウェアは当初から進化し、企業の機密データを盗むための攻撃として好まれています。

初期のランサムウェア攻撃は、主に会社の活動を中断し、ブロックしました。2019年末、NISTはランサムウェアを「**攻撃者が組織のデータを暗号化し、アクセスを回復するために支払いを要求する悪意のある攻撃の一種**」と定義しました。データの暗号化と暗号化キーの源泉徴収は、支払いの要求に先行していました。

それ以降、利用可能なオプションは以下のとおりです。

*   最終的に復号化キーを取得してデータを回復することを希望する**身代金を支払います**。しかし、それが機能するか、攻撃者が後で再試行しないことを保証しません。
*   **身代金を支払わずに**、バックアップからシステムをリストアします。バックアップが引き続き物理的に使用可能で、一貫性があり、ビジネスの維持に十分な速さでリストア可能であることを望みます。

この最終的な対応に備えておらず、対処する必要が予想されていなかった場合、このタイプの攻撃がビジネスにもたらす混乱は、克服するための非常に課題でした。このメッセージを見ていると、きっと極端なストレス状態になるでしょう!

![ランサムウェア画面](./images/intro-hack-02.png "ランサムウェア画面")

ランサムウェアは急速に進化した。[2020年のMS-ISAC](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&ved=2ahUKEwjAo9Wi_fX3AhUG_IUKHVTIDcUQFnoECBUQAQ&url=https%3A%2F%2Fwww.cisa.gov%2Fsites%2Fdefault%2Ffiles%2Fpublications%2FCISA_MS-ISAC_Ransomware%2520Guide_S508C.pdf&usg=AOvVaw1T7xwLzdEx9zlCoNSNytU0)によると、「悪意のあるアクターは時間の経過とともにランサムウェアの戦術を調整し、盗まれたデータを公表することを拒否し、被害者を二次的な形態の恐喝として名前を付け、恥ずかしいと脅かすことによって犠牲者に支払うように圧力をかけることを含めています。

つまり、システムを暗号化して使用不可にする前に、攻撃者は機密データを盗み、身代金の支払いを拒否した場合に漏洩して販売する準備ができています。泥棒たちは、単にバックアップから回復するのではなく、身代金を支払う可能性を高めるために戦術を修正しました。以下のように、泥棒がデータを盗むために使用するいくつかの技術があります。

![データベースの攻撃面](./images/intro-hack-03.png "データベースの攻撃面")

幸いなことに、Oracle Databaseは、サイバー脅威の防止、検出、分析のために市場で最も装備されているデータベースです。

### さらに進むために: ランサムウェア攻撃の段階

サイバー攻撃を特徴付けるいくつかのステップがあり、攻撃者は通常同じ順序でそれらに従います。

ランサムウェアは大きなビジネスです- 収入面では、Global 100に含めるのに十分な大きさかもしれません!最新のランサムウェア・ギャングは、専門的に編成され、運用的にサイロ化されています。専門グループは、ランサムウェアプロセスの特定の段階で専門家になります。これらのグループは、専門的なスキルを持っていない、または時間を節約したい他のグループにサービスや不正行為の結果を販売します- 他の大企業と同様にスケールアップします。このアジャイルなアプローチにより、ランサムウェア・ギャングは、捕捉および起訴されるリスクを制限しながら、より低い運用コストで収益を生み出す能力を高めます。

![攻撃の段階](./images/intro-hack-04.png "攻撃の段階")

#### **ステップ1-5: 嵐の前の静けさ**

サイバー攻撃の最初の4段階は、これらの攻撃が最も脆弱で、多くの場合、ユーザーから始まっているシステムをターゲットにしているため、ユーザーがサイバー攻撃を受けることなく発生する可能性があります。たとえば、攻撃者は、フィッシング電子メール攻撃の送信、悪意のあるWebサイトの設定、偽のソフトウェア・アップグレード・アラートの送信、感染したUSBドライブの提供など(**1 - Reconnaissance**)、リンクをクリックしたり、ダウンロードしたりして、ソーシャル・ネットワークを使用している会社のスタッフをターゲットにしてターゲット・システムに侵入します。ファイル、ビデオなどのアクション(**2 - Weaponization**)を視聴して、攻撃者が会社のネットワーク上のシステム上の小さなマルウェアパッケージ(**3 - Delivery**)をダウンロードして、既存の脆弱性をシステムに悪用し、より適切な足場(**4 - Exploitation**)を得ることができます。マルウェアがシステムに侵入すると、悪意のあるコードは、攻撃者への永続的なアクセスを許可する通信回線であるバックドアを設定します(**5 - Installation**)。この時点で、マルウェアは、攻撃者が攻撃を開始するか、このバックドアを別の攻撃者に販売することを選択する前に、数日、数週間、または数ヶ月間隠れて休眠状態になる可能性があります!

これらのリスクに対する意識とトレーニングスタッフの育成は、これらの第一段階と戦うために不可欠です。従業員は、特にソーシャル・ネットワークで安全を維持するためのベスト・プラクティスを理解する必要があります。技術レベルでは、Webアプリケーションファイアウォール、スパム対策、ウイルス対策、侵入検知システムを自社で装備する必要があります。定期的な侵入テストとセキュリティ監査も非常に役立ちます。

#### **ステップ6: 風が上がる**

攻撃者がネットワーク内にビーチヘッドを持つと、攻撃者はバックドアをアクティブ化し、攻撃キットとリモートで通信して実際の攻撃に備えます。これにより、攻撃者はターゲットのネットワーク内の「ハンズオンキーボードアクセス」(**6 - Command and Control (C2)**)が提供されます。

ここでは、複数のバックドアを確立し、ネットワークをスキャンして盗むゴールデン資産(**6a - 横方向の動き**)を発見するために、他のシステムを広げて攻撃し始めます。攻撃する最も価値の高いシステムの1つは、企業ディレクトリ(通常はMicrosoft Active Directory)とDNSサーバーです。これら2つのシステムを正常に導入すると、他の多くのシステムに侵入できます。

したがって、システムのアーキテクチャのマッピングを開始して、どのサーバーが役に立つか、どのサーバーを妥協する必要があり、どのサーバーを回避する必要があるかを発見できます。もちろん、新しい脆弱性を特定しようとしますが、資格証明の収集または盗用によって権限(**6b - 権限のエスカレーション**)を高めるためにできることはすべて行います。この段階は非常に時間がかかる可能性がありますが、攻撃の最終的な成功には重要です。組織全体に広く広がるのに十分な時間を与えるために、攻撃者はレーダーの下でスマートに働くことによって見つけられないようにしようとします。

攻撃の各段階では、攻撃者の異なるグループ間の引き渡しが見られることがあります。1つの特殊グループが、攻撃をさらに進める別のグループに結果を売り込むためです。

#### **ステップ7: 嵐の中**

現在、攻撃者は標的システムを知り、適切なツールを持ち、行動するための十分な特権を持っているので、ミッションを達成するためのすべてが整備され、実際の攻撃を開始できます。この攻撃は、攻撃者が組織を完全に守られないように選択して捕まえるたびに発生する可能性があります(**7 - 目標に対するアクション**)。攻撃が開始されると、組織が攻撃が発生していることを特定し、緩和と回復の取り組みが実施される可能性があることさえ、時間に対する競争になる可能性があります。

攻撃が開始されると、システムやデータが危険にさらされます。緩和およびリカバリ計画がないと、機密データを変更または開示でき、システムのダウンタイムは数日から数か月です。ほとんどの場合、一部のデータは復元されません。ランサムウェア攻撃の結果はコストがかかり、収益とブランドの評判の両方にとって致命的になる可能性があります。

攻撃者がデータベースを監視することを期待します。データベースは大量の機密データのリポジトリであり、その悪用と分析を容易にするために特別に設計されたシステムに格納されます。攻撃者が、データベースに侵入し、1つのクエリ(**7a - Data Exfiltration**)で数百万のレコードを除外できる場合、複数のサーバー上の何百ものファイルから情報を盗むエネルギーを浪費する必要があるのはなぜですか?今日、一部のハッカーは、強力なデータベーススキルを持つデータ抽出を専門とし、これらのスキルを持たない他の犯罪グループにターゲットを絞った攻撃のためのサービスを販売しています。

機密データを抽出するには、いくつかの方法があります。

*   ネットワーク・トラフィックのスニッフィングによる転送中
*   保存時に、データベース・アクセス制御をバイパスしてディスクから直接(データファイル、エクスポートまたはバックアップ・ファイル)
*   非本番データベースなどの複製データベースから
*   たとえば、SQLインジェクション攻撃を使用するアプリケーションから
*   脆弱性、不正な設定などを利用するか、有効な使用資格証明を危険にさらすことによって、本番データベースから

データが収集されると、攻撃者はそれをコマンド・アンド・コントロール(C2)サーバーに送り返します。通常は、HTTPSトンネルを介してDark Netの専用プラットフォームにゆっくりと送り返します。あなたの境界防御のために、それは誰かがSSLで保護されたウェブサイトを閲覧しているようです。

これは、データがファイアウォール外でwhat-knows-whatの目的で使用され、現在、攻撃者はバックアップを含むシステムを暗号化し、身代金を要求します(**7b - Deploy Ransomware**)。支払いたくない場合は、公開を脅かすことによって支払うように圧力をかけるために流出したデータのサンプルをお送りします。

残念ながら、身代金を支払うかどうかにかかわらず、機密データは現在そこにあり、漏洩または再販される可能性はまだ非常に高いです。「歯磨き粉はもうチューブに収まらない」ので手遅れです!

**そのため、このラボで話し合うステップを実行して、機密データを保護し、データの盗難を回避します。そうすれば、攻撃された後にこれらの問題に対処することはできなくなります**。

## 謝辞

*   **著者** - Hakim Loumi氏、データベース・セキュリティ担当シニア・プリンシパルPM
*   **貢献者** - Russ Lowenthal
*   **最終更新者/日付** - Hakim Loumi - 2022年8月