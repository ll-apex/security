# アラートの生成

## 概要

アラートとは、ターゲット・データベースで特定の監査イベントが発生したときに通知されるメッセージです。Oracle Data Safeでは、ターゲット・データベースでのアラート・ポリシーのプロビジョニング、アラートの表示および管理、事前定義済アラート・レポートの表示およびカスタム・アラート・レポートの作成を行うことができます。

まず、Oracle Data Safeの事前定義済アラート・ポリシーを確認し、そのうち2つをプロビジョニングします。データベース・アクションを使用して、ターゲット・データベースでアクティビティを実行し、Oracle Data Safeでアラートを生成します。生成されたアラートを確認し、カスタム・アラート・レポートを作成します。レポートをPDFとしてダウンロードします。

推定ラボ時間: 20分

### 目標

この演習では、次のことを行います。

*   Oracle Data Safeアラート・ポリシーの確認
*   ターゲット・データベースのアラート・ポリシーのプロビジョニング
*   ターゲット・データベースでアクティビティを実行して、Oracle Data Safeでアラートを生成します
*   Oracle Data Safeのアラートの確認
*   アラートの詳細を表示してクローズします
*   カスタム・アラート・レポートの作成
*   カスタム・アラート・レポートをPDFとして生成およびダウンロードします
*   アラート・レポート履歴の表示

### 前提条件

この演習では、次を想定しています。

*   Oracle Cloudアカウントを取得し、Oracle Cloud Infrastructureにサインインします。
*   このワークショップのための環境の準備([環境の準備](?lab=prepare-environment)を参照)
*   ターゲット・データベースをOracle Data Safeに登録しました。ターゲット・データベースの`ADMIN`パスワードが手元にあることを確認してください([Oracle Data SafeへのAutonomous Databaseの登録](?lab=register-autonomous-database)を参照)。
*   Oracle Data Safeでターゲット・データベースの監査データ収集を開始しました([監査データベース・アクティビティ](?lab=audit-database-activity)を参照)

### 前提

*   実際のデータ値は、多くの場合、スクリーンショットに表示されている値とは異なります。

## タスク1: Oracle Data Safeアラート・ポリシーの確認

1.  **セキュリティ・センター**で、**「アラート」**をクリックします。
    
    **「アラート」**ページが表示されます。アラート・ポリシーをまだ有効にしていないため、アラート・ダッシュボードにデータはありません。
    
    ![データなしのアラート・ダッシュボード](images/alerts-dashboard-no-data.png "データなしのアラート・ダッシュボード")
    
2.  **「関連リソース」**で、**「アラート・ポリシー」**をクリックします。
    
3.  Oracle Data Safeによって提供される使用可能なアラート・ポリシーのリストを確認します。これらは次のとおりです。
    
    *   管理ユーザーによる失敗ログイン
    *   プロファイル変更
    *   データベース・パラメータの変更
    *   監査ポリシーの変更
    *   ユーザーの作成/変更
    *   ユーザー権限の変更
    *   データベース・スキーマの変更
    
    ![Oracle Data Safeアラート・ポリシー](images/oracle-data-safe-alert-policies.png "Oracle Data Safeアラート・ポリシー")
    
4.  **「ユーザー作成/変更」**アラート・ポリシーをクリックし、その詳細を確認します。
    
    **「ユーザーの作成/変更」**アラート・ポリシーの**「アラート・ポリシーの詳細」**ページが表示されます。
    
    ![ユーザー作成変更アラート・ポリシーの詳細](images/user-creation-modification-alert-policy-details.png "ユーザー作成変更アラート・ポリシーの詳細")
    
5.  **「ターゲット・データベースに適用されたポリシー」**の横にある**「リストの表示」**をクリックして、アラート・ポリシーに関連付けられたターゲット・データベースを表示します。
    
    **「ターゲット・ポリシー・アソシエーション」**ページが表示され、**「ポリシー名」**フィルタが**「ユーザー作成/変更」**に設定されます。アラート・ポリシーをどのターゲット・データベースにもまだ関連付けていないため、表には**「使用可能なターゲット・ポリシー・アソシエーションがありません」**と表示されます。
    
    ![使用可能なターゲット・ポリシー・アソシエーションがありません](images/no-target-policy-associations.png "使用可能なターゲット・ポリシー・アソシエーションがありません")
    

## タスク2: ターゲット・データベースでのアラート・ポリシーのプロビジョニング

1.  **「フィルタ」**の下の**「ポリシー名」**ドロップダウン・リストから、**「すべて」**を選択します。
    
2.  **「ターゲット・ポリシー・アソシエーション」**ページで、**「ポリシーの適用」**をクリックします。
    
    「**Apply and Enable Alert Policy to Target Databases**」パネルが表示されます。
    
3.  **「選択したターゲットのみ」**を選択します。
    
4.  必要に応じて、**「コンパートメントの変更」**をクリックし、コンパートメントを選択します。
    
5.  ドロップダウン・リストから、ターゲット・データベースを選択します。
    
6.  **「選択したポリシーのみ」**を選択します。
    
7.  ドロップダウン・リストから、一度に1つずつ、**「ユーザー作成/変更」**および**「管理ユーザーによる失敗したログイン」**アラート・ポリシーを選択します。
    
8.  **「ポリシーの適用」**をクリックし、パネルを閉じることができるというメッセージが表示されるまで待ちます。
    
    ![「ターゲット・データベースへのアラート・ポリシーの適用および有効化」パネル](images/apply-and-enable-alert-policy-panel.png "「ターゲット・データベースへのアラート・ポリシーの適用および有効化」パネル")
    
9.  「**Close**」をクリックします。
    
    ターゲット・データベースの2つのターゲット・ポリシー・アソシエーションがページにリストされ、有効化およびアクティブになります。ターゲット・ポリシー・アソシエーションが表示されない場合は、ポリシー名のフィルタが**「ユーザー作成/変更」**に設定されている場合はクリアしてください。
    
    ![ターゲット・データベースの2つのターゲット・ポリシー・アソシエーション](images/two-target-policy-associations-for-target.png "ターゲット・データベースの2つのターゲット・ポリシー・アソシエーション")
    

## タスク3: Oracle Data Safeでアラートを生成するためのターゲット・データベースのアクティビティの実行

このタスクでは、データベース・アクションでターゲット・データベースでアクティビティを実行して、監査データを生成します。まず、間違ったパスワードを持つ`ADMIN`ユーザーとして意図的にログインしようとします。次に、サインインしてユーザー・アカウントを作成します。

1.  データベース・アクションのSQLワークシートに戻ります。
    
2.  セッションが期限切れになった場合は、問題ありません。**「OK」**をクリックし、**「終了」**をクリックします。それ以外の場合は、右上隅のドロップダウン・リストから**「サインアウト」**を選択し、ダイアログ・ボックスで**「終了」**をクリックします。
    
    **「サインイン」**ページが表示されます。ユーザー名フィールドには、`ADMIN`ユーザーが事前に移入されます。
    
3.  これを2回実行します: 不正なパスワードを入力し、**「ログイン」**をクリックします。
    
    **「無効な資格証明」**メッセージが表示されます。
    
    ![無効なデータベース・パスワード・メッセージ](images/invalid-database-password.png "無効なデータベース・パスワード・メッセージ")
    
4.  正しいパスワードを入力し、**「Sign in」**をクリックします。
    
5.  必要に応じて、**「開発」**で**「SQL」**をクリックします。
    
6.  ワークシートをクリアし、次のSQLスクリプトを貼り付けます。`your-password`を任意のパスワードに置き換えます。パスワードは12から30文字の長さで、少なくとも1つの大文字、1つの小文字および1つの数字を含める必要があります。ユーザー名または二重引用符(")文字を含めることはできません。
    
        <copy>drop user MALFOY cascade;
        create user MALFOY identified by your-password;
        grant PDB_DBA to MALFOY;</copy>
        
7.  ツールバーで、**「スクリプトの実行」**ボタンをクリックし、スクリプトの実行が終了するまで待ちます。
    
8.  スクリプトの出力で、`MALFOY`ユーザーが正常に削除され、再作成されたことを確認します。
    
9.  Oracle Data Safeのブラウザ・タブに戻り、Oracle Data Safeがアラートを生成するまで数分待ちます。
    

## タスク4: Oracle Data Safeでのアラートの確認

1.  左側の**「セキュリティ・センター」**で、**「アラート」**をクリックします。
    
2.  左側の**「フィルタ」**で、ターゲット・データベースを選択します。
    
3.  アラート・ダッシュボードにデータがあることを確認します。
    
    *   **「アラートのサマリー」**チャートには、4つのアラートがあることが示されています。2つはクリティカル・リスク、2つは中リスクです。
    *   **「オープン・アラート」**チャートには、現在日に4つのアラートがあることが示されます。
    *   **「アラート・サマリー」**タブには、クリティカル・アラート、高アラートおよび中アラートの数がターゲット・データベースの数とともに表示されます。アラートおよびターゲット・データベースの合計数も表示されます。
    *   **「ターゲットのサマリー」**タブには、オープン・アラート、クリティカル・アラート、高アラートおよび中アラートの数が表示されます。
    
    ![データを含むアラート・ダッシュボード](images/alerts-dashboard-with-data.png "データを含むアラート・ダッシュボード") ![「ターゲット・サマリー」タブ](images/targets-summary.png "「ターゲット・サマリー」タブ")
    
4.  **「関連リソース」**で、**「レポート」**をクリックします。
    
5.  右側の**「レポート名」**列で、**「すべてのアラート」**レポートをクリックして表示します。
    
    ![「すべてのアラート」レポート](images/alerts-reports.png "「すべてのアラート」レポート")
    
6.  レポートを確認します。
    
    *   レポートは自動的にフィルタされ、過去1週間の選択したコンパートメント内のすべてのターゲット・データベースのすべてのアラートが表示されます。カスタム・フィルタを手動で作成するには、**SCIMクエリー・ビルダー**を使用します。
    *   ターゲット・データベースの合計数、オープン・アラートとクローズ・アラートの合計数、クリティカル・アラート、高アラート、中アラートおよび低アラートの合計数など、いくつかの合計を表示できます。**「ターゲット」**の合計をクリックすると、ターゲット・データベースのリストを表示できます。その他の合計をクリックすると、アラートのリストのフィルタを切り替えることができます。
    *   レポートの下部で、アラートのリストを表示できます。デフォルトでは、表には、アラート名、アラート・ステータス、アラート重大度、監査イベントが発生したターゲット・データベース、およびアラートが作成された日時が表示されます。
    *   PDFまたはXLSレポートの作成、カスタム・レポートの作成、カスタム・レポートのスケジュール、アラートのオープンとクローズ、およびページに表示する表の列の指定を行うオプションがあります。
    
    ![「すべてのアラート」レポート](images/all-alerts-report.png "「すべてのアラート」レポート")
    
7.  レポートの上部にある**「+別のフィルタ」**をクリックします。フィルタ**「ターゲット・データベース= your-target-database-name」**を作成し、**「適用」**をクリックします。
    
    表には、ターゲット・データベースに関連するアラートのみがリストされます。
    
8.  **「+別のフィルタ」**をクリックします。フィルタ**「アラート名= ユーザー作成/変更」**を作成し、**「適用」**をクリックします。
    
    表には、ユーザーの作成/変更に関連するアラートのみが表示されます。
    
9.  **ユーザー作成/変更**用に生成されたアラートを確認します。
    
    ![ユーザーの作成/変更アラート](images/alerts-user-creation-modification.png "ユーザーの作成/変更アラート")
    

## タスク5: アラートの詳細の表示とクローズ

1.  いずれかのアラート名をクリックすると、その詳細が表示されます。
    
2.  アラートに関する次の情報を確認します。
    
    *   アラート名(アラートのインスタンス)
    *   アラートが適用されるターゲット・データベース
    *   アラート重大度
    *   アラート・ステータス- アラートがオープンであるかクローズであるか
    *   アラート・タイプ- 現在、すべてのアラート・タイプはAUDITINGです
    *   アラートを生成したポリシー
    *   アラートを生成したユーザー操作
    *   操作時間およびステータス
    *   アラートの作成と更新
    *   Oracle Cloud Identifier (OCID) for the alert
    *   アラートが存在するコンパートメント
    *   操作の詳細
    
    ![アラート詳細ページ](images/alert-details-page.png "アラート詳細ページ")
    
3.  アラートを閉じるには**「閉じる」**をクリックします。
    
    アラートステータスはただちに **CLOSED**に設定されます。
    

## タスク6: カスタム・アラート・レポートの作成

1.  ページ上部のブレッドクラムで、**「すべてのアラート」**をクリックして「すべてのアラート」レポートに戻ります。
    
2.  すでに設定されているデフォルトのフィルタに加えて、さらに2つのフィルタを追加します。
    
    *   **ターゲット・データベース= your-target-database-name**
    *   **アラート名= 管理ユーザーによる失敗ログイン**
3.  **「カスタム・レポートの作成」**をクリックします。
    
    **「カスタム・レポートの作成」**ダイアログ・ボックスが表示されます。
    
4.  **「表示名」**に、**「your-target-database-nameの管理ユーザーによる失敗したログイン」**と入力します。(オプション)説明を入力します。コンパートメントを選択します。**「カスタム・レポートの作成」**をクリックし、レポートが生成されるまで待ちます。
    
    ![「カスタム・レポートの作成」ダイアログ・ボックス](images/create-custom-report-dialog-box.png "「カスタム・レポートの作成」ダイアログ・ボックス")
    
5.  「**Click here**」リンクをクリックしてレポートを表示します。
    

## タスク7: PDFとしてのカスタム・アラート・レポートの生成およびダウンロード

1.  カスタム・レポート・ページで、「**レポートの生成**」をクリックします。
    
    **レポートの生成**ダイアログ・ボックスが表示されます。
    
2.  **「PDF」**は選択したままにします。
    
3.  表示名**Failed Admin Logins for your-target-database-name**を入力します。
    
4.  (オプション)**「説明」**に、**「ターゲット・データベースyour-target-database-nameの管理ユーザーによる失敗したログイン」**と入力します。
    
5.  コンパートメントを選択したままにして、行制限を10000に設定したままにして、レポート開始時間をそのままにします。
    
6.  **「レポートの生成」**をクリックし、PDFレポートが作成されるまで待ちます。
    
    メッセージが表示され、レポートの生成が完了したことが示されます。
    
    ![「レポートの生成」ダイアログ・ボックス](images/generate-report-dialog-box.png "「レポートの生成」ダイアログ・ボックス")
    
7.  **ここ**のリンクをクリックしてレポートをダウンロードします。
    
8.  必要に応じて、レポートをローカル・コンピュータに保存することを選択します。
    
9.  PDFレポートを開いて表示します。終了したら、ブラウザ・タブを閉じます。
    
    ![管理ログイン失敗PDFレポート](images/failed-admin-logins-report-pdf.png "管理ログイン失敗PDFレポート")
    
10.  **「レポートの生成」**ダイアログ・ボックスで、**「閉じる」**をクリックします。
    

## タスク8: アラート・レポート履歴の表示

1.  **「関連リソース」**で、**「アラート・レポート履歴」**をクリックします。
    
2.  カスタム・レポートがリストされていることを確認します。状態、その説明、生成日時、生成者(`GENERATED`)またはスケジューラによって生成されたかどうか、ダウンロード可能なファイル形式およびダウンロード・アイコンを表示できます。Oracle Data Safeでは、レポートを最大3か月間使用できます。
    
    ![アラート・レポート履歴](images/alert-report-history.png "アラート・レポート履歴")
    

**次の演習に進む**ことができます。

## さらに学ぶ

*   [アラートの概要](https://www.oracle.com/pls/topic/lookup?ctx=en/cloud/paas/data-safe&id=UDSCS-GUID-37F8AC38-44D4-42D1-AE93-9775DCF21511)

## 謝辞

*   **著者** - データベース開発、コンサルティング・ユーザー・アシスタンス開発者、Jody Glover
*   **最終更新者/日付** - Jody Glover、2023年6月8日