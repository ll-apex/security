# データベース・ユーザーの評価

## 概要

ユーザー評価は、データベース・ユーザーのセキュリティを評価し、潜在的な高リスク・ユーザーを識別するのに役立ちます。デフォルトでは、Oracle Data Safeによってターゲット・データベースのユーザー評価が自動的に生成され、評価履歴に格納されます。すべてのターゲット・データベースおよび各ターゲット・データベースの評価データを分析できます。最新の評価をベースラインまたは別の評価と比較することで、ターゲット・データベースのセキュリティ・ドリフトを監視できます。

この演習では、ユーザー評価を確認します。

推定ラボ時間: 20分

### 目標

この演習では、次のことを行います。

*   ユーザー・アセスメントの概要ページの表示
*   最新のユーザー評価でのユーザーの分析
*   `ADMIN`ユーザーの監査レコードを確認します。
*   ターゲット・データベースにユーザーを作成します
*   最新のユーザー評価を更新し、名前を変更します
*   ターゲット・データベースのユーザー評価履歴の表示
*   最新ユーザー評価と初期ユーザー評価との比較
*   最新のユーザー評価をPDFレポートとしてダウンロード
*   すべてのターゲット・データベースのユーザー評価履歴の表示

### 前提条件

この演習では、次を想定しています。

*   Oracle Cloudアカウントを取得し、Oracle Cloud Infrastructure Consoleにサインインします。
*   このワークショップのための環境の準備([環境の準備](?lab=prepare-environment)を参照)
*   ターゲット・データベースをOracle Data Safeに登録しました([Autonomous DatabaseのOracle Data Safeへの登録](?lab=register-autonomous-database)を参照)
*   Oracle Data Safeでターゲット・データベースの監査データ収集を開始しました([データベース・アクティビティの監査](?lab=audit-database-activity)を参照)。ユーザー評価内からユーザーの監査レコードを表示する場合は、監査データの収集が必要です。

### 前提条件

*   実際のデータ値は、スクリーンショットに表示されている値と異なる場合があります。

[データベース・ユーザーの評価](videohub:1_fvykqng1)

## タスク1: ユーザー・アセスメントの概要ページの表示

1.  **「ユーザー評価」**にナビゲートします。これを行うには、ページ上部のブレッドクラムで、**「セキュリティ・センター」**をクリックします。左側の**「ユーザー評価」**をクリックします。
    
2.  **「リスト範囲」**で、コンパートメントが選択されていることを確認します。**「子コンパートメントを含める」**の選択を解除します。
    
3.  概要ページの上部で、4つのチャートを確認します。
    
    *   **「Potential User Risk」**チャートには、**「Critical」**、**「High」**、**「Medium」**および**「Low」**リスクの可能性があるユーザーの数が表示されます。
    *   **「ユーザー・ロール」**チャートには、**DBA**、**DV管理**および**監査管理**の各ロールを持つユーザーの数が表示されます。
    *   **「最終パスワード変更」**チャートには、過去30日間、過去30-90日間および90日以上前にパスワードを変更したユーザーの数が表示されます。
    *   **「最終ログイン」**チャートには、過去24時間、過去1週間、今月、今年および1年以上前にターゲット・データベースにサインインしたユーザーの数が表示されます。
    
    ![ユーザー・アセスメントの概要ページ・チャート](images/ua-dashboard-charts.png "ユーザー・アセスメントの概要ページ・チャート")
    
4.  **「リスクのサマリー」**タブを確認します。
    
    *   **「リスク・サマリー」**タブは、選択したすべてのターゲット・データベースにおける潜在的なリスクに重点を置いています。潜在的なリスク・レベル、ターゲット・データベースの数、各リスク・レベルのユーザーの合計数、各リスク・レベルの特権ユーザーの合計数、DBA、DV管理者および監査管理者の数が表示されます。
    *   潜在的なリスク・レベルは、**「クリティカル」**、**「高」**、**「中」**および**「低」**に分類されます。
    
    ![ユーザー・アセスメント・リスクの「サマリー」タブ](images/ua-risk-summary-tab.png "ユーザー・アセスメント・リスクの「サマリー」タブ")
    
5.  **「ターゲットのサマリー」**タブをクリックします。このタブには、次の情報が表示されます:
    
    *   クリティカルおよび高リスクのユーザー数、DBA、DV管理者および監査管理者
    *   最新のユーザー評価の日時
    *   最新のユーザー評価がベースラインから逸脱しているかどうか(設定されている場合)
    
    ![ユーザー・アセスメント・ターゲットの「サマリー」タブ](images/ua-target-summary-tab.png "ユーザー・アセスメント・ターゲットの「サマリー」タブ")
    

## タスク2: 最新のユーザー評価でのユーザーの分析

最新のユーザー評価は、ターゲット・データベースの登録時にOracle Data Safeによって自動的に生成されます。

1.  **「ターゲットのサマリー」**タブで、**「レポートの表示」**をクリックして、ターゲット・データベースの最新のユーザー評価を表示します。
    
2.  **「概要」**タブのレポートの上部で、**「潜在的なユーザー・リスク」**、**「ユーザー・ロール」**、**「最終パスワード変更」**および**「最終ログイン」**チャートを確認します。
    
    ![ユーザー評価最新チャート](images/ua-latest-charts.png "ユーザー評価最新チャート")
    
3.  **「アセスメント情報」**タブをクリックします。次の情報を表示できます。
    
    *   最新のユーザー評価の名前
    *   最新のユーザー・アセスメントのOCID
    *   最新のユーザー評価が属するコンパートメント
    *   ターゲット・データベース名
    *   査定の日時
    *   最新の評価のスケジュール
    *   最新アセスメントがベースライン・アセスメントとして設定されているかどうか
    *   最新の評価がベースライン評価に準拠しているかどうか(設定されている場合)
    
    ![最新ユーザー・アセスメントの「アセスメント情報」タブ](images/ua-assessment-information-tab-latest-assessment.png "最新ユーザー・アセスメントの「アセスメント情報」タブ")
    
4.  下にスクロールして、**「ユーザー詳細」**セクションを確認します。デフォルトでは、この表には各ユーザーに関する次の情報が表示されます。
    
    *   ユーザー名
    *   ユーザー・タイプ(PRIVILEGED、SCHEMAなど)
    *   ユーザーがDBA、DV管理または監査管理であるかどうか
    *   潜在的なリスク・レベル(LOW、HIGH、CRITICALなど)
    *   ユーザーのステータス(OPEN、LOCKED、EXPIRED\_AND\_LOCKEDなど)
    *   ユーザーがターゲット・データベースに前回ログインした日時
    *   ユーザー・プロファイル
    *   ユーザーの監査レコード
    
    ![ユーザー・アセスメント最新アセスメント詳細](images/ua-latest-user-details.png "ユーザー・アセスメント最新アセスメント詳細")
    
5.  **「User Name」**列で、**CRITICAL**の潜在的なリスクであるユーザー(**EVIL\_RICH**など)をクリックします。
    
    **「ユーザーの詳細」**パネルには、ユーザーに関する次の情報が表示されます。
    
    *   ターゲット・データベース名
    *   ユーザー名
    *   ユーザー・プロファイル
    *   ユーザー・タイプ(PRIVILEGEDなど)
    *   ステータス(OPENなど)
    *   潜在的なリスク(CRITICALなど) - **i**にマウスポインタを重ねると、重要なリスクユーザーの構成要素が表示されます。
    *   最終ログイン日時
    *   ユーザーの作成日時
    *   パスワードが変更された日時
    *   特権ロール(ユーザーに付与されている管理ロール)
    *   ロール: **「すべてのロール」**を展開して、ユーザーに付与されているすべてのロールを表示します。
    *   権限: **「すべての権限」**を展開して、ユーザーに付与されているすべての権限を表示します。
    
    ![EVIL RICHユーザー詳細](images/ua-evil-rich-user-details.png "EVIL RICHユーザー詳細")
    
6.  「**Close**」をクリックします。
    
7.  潜在的にクリティカルなリスク・ユーザーのみを表示するようにレポートをフィルタするには、**「概要」**タブをクリックします。**「潜在的なユーザー・リスク」**チャートで、チャートの**「クリティカル」**セクションをクリックします。フィルタが自動的に作成されます。
    
    ![クリティカル・リスク・ユーザー・フィルタ](images/ua-critical-risk-users-filter.png "クリティカル・リスク・ユーザー・フィルタ")
    
8.  フィルタを削除するには、フィルタの横にある**「X」**をクリックします。
    

## タスク3: `ADMIN`ユーザーの監査レコードの確認

1.  `ADMIN`ユーザーの表の行を特定します。`ADMIN`ユーザーの**「監査レコード」**列で、**「アクティビティの表示」**をクリックします。
    
    ![ADMINユーザー監査レコード](images/ua-admin-user-audit-records.png "ADMINユーザー監査レコード")
    
    `ADMIN`ユーザーの**「すべてのアクティビティ」**レポートが表示されます。
    
2.  レポートを確認します。
    
    *   レポートは自動的にフィルタされ、過去1週間、`ADMIN`ユーザー、およびターゲット・データベースの監査レコードが表示されます。
    *   レポートの上部には、**「ターゲット」**、**「DBユーザー」**、**「クライアント・ホスト」**、**「DML」**、**「権限の変更」**、**「DDL」**、**「ユーザー/権限の変更」**、**「ログイン失敗」**、**「ログイン成功」**および**「イベント合計」**の合計が表示されます。
    *   表の**「イベント」**列には、`ADMIN`ユーザーが実行するアクティビティのタイプ(`GRANT`、`LOGON`、`CREATE USER`など)が表示されます。
    *   ページの下部で、ページ番号をクリックしてさらに監査レコードを表示できます。
    
    ![ADMINユーザーのすべてのアクティビティ・レポート](images/ua-all-activity-report-admin-user.png "ADMINユーザーのすべてのアクティビティ・レポート")
    

## タスク4: ターゲット・データベースでのユーザーの作成

1.  **「データベース・アクション」**でSQLワークシートにアクセスします。
    
2.  必要に応じて、ワークシートおよび**「スクリプト出力」**タブをクリアします。
    
3.  SQLワークシートで、次のコマンドを入力します。
    
        <copy>CREATE USER joe_smith identified by Oracle123_Oracle123;
        GRANT PDB_DBA to joe_smith;</copy>
        
4.  ツールバーで、**「スクリプトの実行」**ボタン(白い矢印付きの緑の円)をクリックして問合せを実行します。
    
    ![「スクリプトの実行」ボタン](images/run-script.png "「スクリプトの実行」ボタン")
    
5.  ページ下部の**「スクリプト出力」**タブで、`JOE_SMITH`ユーザーが作成され、付与が成功したことを確認します。
    

## タスク5: 最新のユーザー評価のリフレッシュと名前の変更

1.  Oracle Data Safeのブラウザ・タブに戻ります。
    
2.  左側の**「Security Center」**で、**「User Assessment」**をクリックします。
    
3.  **「ターゲットのサマリー」**タブをクリックします。
    
4.  ターゲット・データベースの**「レポートの表示」**をクリックして、最新のユーザー評価を開きます。
    
5.  最新のユーザー評価をリフレッシュするには、**「今すぐリフレッシュ」**ボタンをクリックします。
    
    ![「User Assessment Refresh Now」ボタン](images/ua-refresh-now-button.png "「User Assessment Refresh Now」ボタン")
    
6.  **「今すぐリフレッシュ」**パネルで、デフォルト名をそのままにして、**「今すぐリフレッシュ」**をクリックします。最新のユーザー評価のステータスが**SUCCEEDED**と表示されるのを待ちます。Oracle Data Safeでは、評価の静的コピーが評価履歴に自動的に保存されます。
    
    ![ユーザー評価の「今すぐリフレッシュ」パネル](images/ua-refresh-now-panel.png "ユーザー評価の「今すぐリフレッシュ」パネル")
    
7.  リフレッシュされた最新の評価をレビューします。作成したユーザー`JOE_SMITH`がリストされていることを確認します。
    
8.  **「評価情報」**タブをクリックし、評価名の横にある**鉛筆**アイコンをクリックします。名前を**「最新ユーザー評価」**に変更し、**「保存」**アイコンをクリックします。ステータスが **UPDATING**から **SUCCEEDED**に変更されるまで待ちます。ページ上で名前が更新されます。
    
    ![名前が変更された最新のユーザー評価](images/ua-renamed-latest-assessment.png "名前が変更された最新のユーザー評価")
    

## タスク6: ターゲット・データベースのユーザー評価履歴の表示

1.  **「最新のユーザー評価」**ページの上部で、**「履歴の表示」**をクリックします。
    
2.  コンパートメントが選択されていることを確認します。**「子コンパートメントを含める」**の選択を解除します。
    
3.  アセスメントのリストを確認します。
    
    ![最新のユーザー評価のアセスメント履歴](images/user-assessment-history-page.png "最新のユーザー評価のアセスメント履歴")
    
4.  **「閉じる」**をクリックして、最新のユーザー評価に戻ります。
    
    最新のユーザー評価から移動した場合は、ブレッドクラムで**「ユーザー評価」**をクリックして戻ることができます。**「ターゲットのサマリー」**タブをクリックします。ターゲット・データベースの**「レポートの表示」**をクリックします。
    

## タスク7: 最新のユーザー評価と初期ユーザー評価の比較

ユーザー評価を選択して、最新のユーザー評価と比較できます。このオプションでは、ベースラインを設定する必要はありません。このオプションは、最新のユーザー評価を表示している場合にのみ使用できます。

1.  最新のユーザー評価を表示しているときに、左側の**「リソース」**で、**「評価の比較」**をクリックします。
    
2.  **「他のアセスメントとの比較」**セクションまでスクロール・ダウンします。
    
3.  コンパートメントが表示されない場合は、**「コンパートメントの変更」**をクリックしてコンパートメントを選択します。
    
4.  **「評価の選択」**ドロップダウン・リストから、ターゲット・データベースの初期評価(リストの2番目の評価)を選択します。これを選択すると、比較操作が開始されます。
    
5.  **比較**レポートを確認します。
    
    *   レポートには、新規ユーザーが追加されたことが示されます。
    *   **新規ユーザー**の結果は、潜在的な**クリティカル**・リスクです。
    
    ![ユーザー評価比較レポート](images/ua-comparison-report.png "ユーザー評価比較レポート")
    
6.  潜在的クリティカル・リスク結果の**「比較結果」**列で、**「詳細を開く」**リンクをクリックして詳細情報を表示します。
    
    **「比較の詳細」**パネルが表示されます。
    
    ![「比較詳細」パネル](images/ua-comparison-details-panel.png "「比較詳細」パネル")
    
7.  情報を確認し、**「閉じる」**をクリックします。
    

## タスク8: 最新のユーザー評価をPDFレポートとしてダウンロード

1.  最新のユーザー評価ページの上部にある**「他のアクション」**メニューから、**「レポートの生成」**をクリックします。
    
    **レポートの生成**ダイアログ・ボックスが表示されます。
    
2.  レポート・フォーマットとして**「PDF」**を選択したままにして、**「レポートの生成」**をクリックします。
    
3.  **PDFレポートの生成が完了した**というメッセージを待機してから、**ここ**のリンクをクリックします。
    
    ![ユーザー評価の「レポートの生成」ダイアログ・ボックス](images/ua-generate-report-dialog.png "ユーザー評価の「レポートの生成」ダイアログ・ボックス")
    
4.  PDFを開いて確認します。
    
    ![PDF形式のページ1の最新ユーザー評価](images/ua-pdf-report-page1.png "PDF形式のページ1の最新ユーザー評価")
    
    ![PDF形式のページ2の最新ユーザー評価](images/ua-pdf-report-page2.png "PDF形式のページ2の最新ユーザー評価")
    
5.  PDFを閉じて、Oracle Data Safeのブラウザ・タブに戻ります。
    

## タスク9: すべてのターゲット・データベースのユーザー評価履歴の表示

「ユーザー評価履歴」ページでは、すべてのターゲット・データベースについて、保存されたすべてのユーザー評価のリストを表示できます。

1.  ページ上部のブレッドクラムで、**「ユーザー評価」**をクリックします。
    
2.  **「関連リソース」**で、**「評価履歴」**をクリックします。
    
3.  **「リスト範囲」**で、コンパートメントが選択されていることを確認します。
    
4.  保存したユーザー評価がここにリストされていることを確認します。
    
    *   選択したコンパートメント内のすべてのターゲット・データベースで、クリティカル・リスク、高リスク、DBA、DV管理者および監査管理の数を比較できます。
    *   ベースラインとして設定されたユーザー評価を迅速に識別することもできます。
    
    ![すべてのターゲット・データベースの評価履歴](images/ua-assessment-history-all-targets.png "すべてのターゲット・データベースの評価履歴")
    
5.  ターゲット・データベースでリストをソートするには、**「ターゲット・データベース」**列見出しをクリックします。
    
6.  ターゲット・データベースのユーザー評価の名前をクリックします。保存されたユーザー評価のデータをリフレッシュできないことに注意してください。
    

**次の演習に進む**ことができます。

## さらに学ぶ

*   [ユーザー評価の概要](https://www.oracle.com/pls/topic/lookup?ctx=en/cloud/paas/data-safe&id=UDSCS-GUID-6BF46EE2-F7B5-4710-A09C-069EA95F8052)

## 謝辞

*   **著者** - データベース開発、コンサルティング・ユーザー・アシスタンス開発者、Jody Glover
*   **最終更新者/日付** - Jody Glover、2023年6月8日