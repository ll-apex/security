# アイデンティティおよびアクセス管理

## 概要

Oracle Cloud Infrastructure (OCI) Identity and Access Management (IAM) Serviceでは、クラウド・リソースにアクセスできるユーザーを制御できます。ユーザーのグループのアクセス権のタイプと特定のリソースを制御します。このラボの目的は、IAMサービス・コンポーネントの概要と、それらの連携方法を理解するのに役立つシナリオの例を提供することです。

ラボの概要は、次のビデオをご覧ください。[](youtube:KahdJmhJlYI)

推定時間: 30分

### 目標

この演習では、次のことを行います。

*   区分の作成
*   ユーザーの作成
*   グループの作成
*   グループに関連付けられたポリシーの作成
*   グループへのユーザーの追加

### 前提条件

*   Oracle Cloudアカウント- このワークショップのLiveLabsランディング・ページを参照して、サポートされている環境を確認してください。

> **ノート:** **無料トライアル**・アカウントがある場合、無料トライアルの期限が切れると、アカウントは**Always Free**アカウントに変換されます。Always Free環境が使用可能でないかぎり、Free Tierワークショップは実行できません。

**[Free TierのFAQページはここをクリックしてください。](https://www.oracle.com/cloud/free/faq.html)**

## タスク1: コンパートメントの作成

コンパートメントは、コンピュート・インスタンス、ロード・バランサ、データベースなどのクラウド・アセットの集合です。デフォルトでは、テナンシの作成時にルート・コンパートメントが作成されました(つまり、トライアル・アカウントに登録したとき)。ルート・コンパートメントにすべてを作成することは可能ですが、Oracleでは、リソースをより効率的に管理できるようにサブコンパートメントを作成することをお薦めします。

1.  左上の**「ナビゲーション・メニュー」**をクリックし、**「アイデンティティとセキュリティ」**に移動して**「コンパートメント」**を選択します。
    
    ![](https://oracle-livelabs.github.io/common/images/console/id-compartment.png " ")
    
    **コンパートメントの作成**をクリックします。 ![区分の作成](images/create-compartment.png)
    
2.  コンパートメントに**「デモ」**という名前を付け、簡単な説明を入力します。ルート・コンパートメントが親コンパートメントとして表示されていることを確認します。準備ができたら、青色の**「コンパートメントの作成」**ボタンを押します。
    
    ![コンパートメントの作成](images/compartment-details.png)
    
3.  このテスト・ドライブのすべての作業に対してコンパートメントを作成しました。
    

## タスク2: アクセスを制御するユーザー、グループおよびポリシーの管理

サービスにアクセスするためのユーザーの権限は、それらが属する_グループ_から取得されます。グループの権限はポリシーによって定義されます。ポリシーは、グループのメンバーが実行できるアクションおよびコンパートメントを定義します。ユーザーは、自分がメンバーであるグループに対して設定されたポリシーに基づいて、サービスにアクセスして操作を実行できます。

概念を理解するためのユーザー、グループおよびセキュリティ・ポリシーを作成します。

1.  左上の**「ナビゲーション・メニュー」**をクリックします。**「アイデンティティとセキュリティ」**に移動し、**「グループ」**を選択します。
    
    ![](https://oracle-livelabs.github.io/common/images/console/id-groups.png " ")
    
2.  「**グループの作成**」をクリックします。
    
    **「グループの作成」**ダイアログ・ボックスで、次を入力します:
    
    *   **名前:** **oci-groupなど、グループの一意の名前を入力します**
        
        > **ノート:**グループ名に空白を含めることはできません。
        
    *   **説明:** **ociユーザーの新規グループなど、説明を入力します**
        
    *   **「作成」**をクリックします
        
    
    ![グループの作成](images/create-group.png)
    
3.  新しいグループをクリックして表示します。新しいグループが表示されます。
    
    ![新規グループが表示されます](images/image006.png)
    
4.  次に、割り当てられたコンパートメントでグループ権限を付与するセキュリティ・ポリシーを作成します。たとえば、コンパートメント**デモ**のグループ**oci-group**のメンバーに権限を付与するポリシーを作成します:
    
    a)左上の**「ナビゲーション・メニュー」**をクリックします。**「アイデンティティとセキュリティ」**に移動し、**「ポリシー」**を選択します。 ![](https://oracle-livelabs.github.io/common/images/console/id-policies.png " ")
    
    b)左側で、**「デモ」**コンパートメントを選択します。 ![*デモ・コンパートメントの選択](images/demo-compartment.png)
    
    > **ノート:**サブコンパートメント_**デモ**_を表示できるようにするには、メイン・コンパートメント名の横にある+記号をクリックする必要がある場合があります。サブコンパートメントがまだ表示されていない場合は、_**ブラウザをリフレッシュ**_します。ブラウザでコンパートメント情報がキャッシュされ、内部キャッシュが更新されない場合があります。
    
    c) **「デモ」**コンパートメントを選択した後、**「ポリシーの作成」**をクリックします。 ![](images/img0012.png)
    
    d)ポリシーの一意の**名前**を入力します(例: "Policy-for-oci-group")。
    
    > **ノート:**名前にスペースを含めることはできません。
    
    e) **「説明」**を入力します(たとえば、「OCIグループのポリシー」)。
    
    f)コンパートメントの**「デモ」**を選択します。
    
    g) **「マヌエル・エディタの表示」**をクリックし、次の**文**を入力します。
    
        <copy>Allow group oci-group to manage all-resources in compartment Demo</copy>
        
    
    h) **「作成」**をクリックします。
    
    ![作成](images/create-policy.png)
    
5.  新規ユーザーの作成
    
    a)左上の**「ナビゲーション・メニュー」**をクリックし、**「アイデンティティとセキュリティ」**に移動して**「ユーザー」**を選択します。
    
    ![](https://oracle-livelabs.github.io/common/images/console/id-users.png " ")
    
    b) **「ユーザーの作成」**をクリックします。
    
    **「ユーザーの作成」**ダイアログ・ボックスで、次を入力します:
    
    *   **名前:**新しいユーザーの一意の名前または電子メール・アドレス(**User01**など)を入力します。_この値はコンソールのユーザーのログイン名であり、テナンシ内の他のすべてのユーザー間で一意である必要があります。_
    *   **説明:**説明(たとえば、**New oci user**)を入力します。
    *   **電子メール:**アクセス権のある個人用電子メール・アドレス(GMail、Yahooなど)を使用することをお薦めします。
    
    **「作成」**をクリックします。
    
    ![新規ユーザー・フォーム](images/user-form.png)
    
6.  新しく作成したユーザーの一時パスワードを設定します。
    
    a)ユーザーのリストから、**作成したユーザー**をクリックしてその詳細を表示します。
    
    b) **「パスワードの作成/リセット」**をクリックします。
    
    ![パスワードのリセット](images/image009.png)
    
    c)ダイアログで、**「パスワードの作成/リセット」**をクリックします。
    
    ![パスワードのリセット](images/create-password.png)
    
    d)新しいワンタイム・パスワードが表示されます。**「コピー」**リンクをクリックし、**「閉じる」**をクリックします。このパスワードは必ずメモ帳にコピーしてください。
    
    ![](images/copy-password.png)
    
    e)ユーザー・メニューから**「サインアウト」**をクリックし、管理ユーザー・アカウントから完全にログアウトします。
    
    ![ログアウト](images/sign-out.png)
    
7.  別のWebブラウザまたは認識ウィンドウを使用して、新しいユーザーとしてサインインします。
    
    a)サポートされているブラウザを開き、コンソールURL [https://cloud.oracle.com](https://cloud.oracle.com)に移動します。
    
    b)ブラウザ・ウィンドウの右上セクションにあるポートレート・アイコンをクリックし、**「Oracle Cloudにサインイン」**をクリックします。
    
    c)クラウド・アカウントの名前(ユーザー名ではなくテナンシ名)を入力し、**「次」**ボタンをクリックします。
    
    ![テナント名の入力](images/cloud-account-name.png)
    
    d)今回は、作成したユーザーとともに**「Oracle Cloud Infrastructureダイレクト・サインイン」**ボックスを使用してサインインします。作成したユーザーはIdentity Cloud Servicesの一部ではないことに注意してください。
    
    e)コピーしたパスワードを入力します。**「サインイン」**をクリックします。
    
    ![パスワードを入力してください](images/sign-in.png)
    
    > **ノート:**これは初回サインインであるため、次のスクリーンショットに示すように、一時パスワードを変更するように求められます。
    
    f)新しいパスワードを設定する。**「Save New Password」**をクリックします。 ![新規パスワードの設定](images/image015.png)
    
8.  ユーザー権限を確認します。
    
    a)左上の**「ナビゲーション・メニュー」**をクリックします。**「コンピュート」**をクリックし、**「インスタンス」**をクリックします。
    
    ![](https://oracle-livelabs.github.io/common/images/console/compute-instances.png " ")
    
    b)左側のメニューから任意のコンパートメントを選択してみます。
    
    c)「**You don't have permission to view these resources**」というメッセージが表示されます。ポリシーを関連付けたグループにユーザーを追加しなかったため、これは正常です。 ![エラー・メッセージは無視されます](images/no-permission.png)
    
    d)コンソールからサイン・アウトします。
    
9.  ユーザーをグループに追加します。
    
    a) _**admin**_アカウントで再度サインインします。
    
    b)左上の**「ナビゲーション・メニュー」**をクリックします。**「アイデンティティとセキュリティ」**に移動し、**「ユーザー」**を選択します。**「ユーザー」**リストから、作成したユーザー・アカウント(`User01`など)をクリックして、「ユーザーの詳細」ページに移動します。 ![](https://oracle-livelabs.github.io/common/images/console/id-users.png " ")
    
    c)左側の**「リソース」**メニューで、まだ選択されていない場合は**「グループ」**をクリックします。
    
    d) **「ユーザーをグループに追加」**をクリックします。 ![](images/image020.png)
    
    e) **「グループ」**ドロップダウン・リストから、作成した**oci-group**を選択します。
    
    f) **「追加」**をクリックします。 ![「追加」ボタンを押します](images/add-user-to-group.png)
    
    g) Oracle CloudのWebサイトからサインアウトします。
    
10.  ユーザーが特定のグループに属している場合は、ユーザーの権限を確認します。
    
    a)作成したローカルの **User01**アカウントでサインインします。このユーザーに割り当てた最新のパスワードを使用してください。
    
    b) **「ナビゲーション・メニュー」**をクリックします。**「コンピュート」**をクリックし、**「インスタンス」**をクリックします。
    
    c)左側のコンパートメントのリストからコンパートメント**「デモ」**を選択します。
    
    ![デモの選択](images/select-demo.png)
    
    d)権限に関連するメッセージがないため、新しいインスタンスを作成できます。
    
    e) **「ナビゲーション・メニュー」**をクリックします。**「アイデンティティとセキュリティ」**をクリックして**「グループ」**を選択します。
    
    f) **「Authorization failed or requested resource not found」**というメッセージが表示されます。ユーザーにはグループを変更する権限がないため、これが必要です。
    
    > **ノート:**かわりに、「予期しないエラーが発生しました」というメッセージが表示される場合があります。それも大丈夫です。
    
    ![](images/group-error.png)
    
    g)サインアウトします。
    

_おめでとうございます!演習を正常に完了しました。_

## 謝辞

*   **著者** - Rajeshwari Rai、Prasenjit Sarkar
*   **コントリビュータ** - データベース製品管理、製品マネージャー、Arabella Yao氏
*   **最終更新者/日付** - Arabella Yao、2022年1月